\hypertarget{classadd__trapping}{
\section{add\-\_\-trapping \-Module \-Reference}
\label{classadd__trapping}\index{add\-\_\-trapping@{add\-\_\-trapping}}
}


\-This module contains the function to identify trapped sites.  


\subsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
integer function \hyperlink{classadd__trapping_a3ecc26d4e45d30eb3f1ea423c2464d57}{get\-\_\-label\-\_\-free\-\_\-clusters} (n\-\_\-sites, states, mat)
\begin{DoxyCompactList}\small\item\em \-Ths function does the union of the labels of all sites connected to an exit site and return the corresponding label that is the free cluster's label. \end{DoxyCompactList}\item 
subroutine \hyperlink{classadd__trapping_a06df99a584626d4aac4d7b24332f62ba}{find\-\_\-trapped\-\_\-sites\-\_\-cubic} (nx, ny, nz, states, period\-\_\-x, period\-\_\-y, period\-\_\-z, n\-\_\-sites\-\_\-invaded, invasion\-\_\-list, undo\-\_\-invasion)
\begin{DoxyCompactList}\small\item\em \-Identify trapped sites on cubic lattices. \end{DoxyCompactList}\item 
subroutine \hyperlink{classadd__trapping_aa2943f8f85fd470d63603612b3624573}{find\-\_\-trapped\-\_\-sites\-\_\-arbitrary} (n\-\_\-sites, states, offsets, connectivity, n\-\_\-sites\-\_\-invaded, invasion\-\_\-list, undo\-\_\-invasion)
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-This module contains the function to identify trapped sites. 

\begin{DoxyAuthor}{\-Author}
\-Yder \-M\-A\-S\-S\-O\-N 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
\-October 23, 2014 
\end{DoxyDate}


\subsection{\-Member \-Function/\-Subroutine \-Documentation}
\hypertarget{classadd__trapping_aa2943f8f85fd470d63603612b3624573}{
\index{add\-\_\-trapping@{add\-\_\-trapping}!find\-\_\-trapped\-\_\-sites\-\_\-arbitrary@{find\-\_\-trapped\-\_\-sites\-\_\-arbitrary}}
\index{find\-\_\-trapped\-\_\-sites\-\_\-arbitrary@{find\-\_\-trapped\-\_\-sites\-\_\-arbitrary}!add_trapping@{add\-\_\-trapping}}
\subsubsection[{find\-\_\-trapped\-\_\-sites\-\_\-arbitrary}]{\setlength{\rightskip}{0pt plus 5cm}subroutine add\-\_\-trapping\-::find\-\_\-trapped\-\_\-sites\-\_\-arbitrary (
\begin{DoxyParamCaption}
\item[{integer}]{n\-\_\-sites, }
\item[{integer, dimension(\-:)}]{states, }
\item[{integer, dimension(\-:)}]{offsets, }
\item[{integer, dimension(\-:)}]{connectivity, }
\item[{integer}]{n\-\_\-sites\-\_\-invaded, }
\item[{integer, dimension(\-:)}]{invasion\-\_\-list, }
\item[{logical}]{undo\-\_\-invasion}
\end{DoxyParamCaption}
)}}
\label{classadd__trapping_aa2943f8f85fd470d63603612b3624573}
\begin{DoxyAuthor}{\-Author}
\-Yder \-M\-A\-S\-S\-O\-N 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
\-October 23, 2014
\end{DoxyDate}

\begin{DoxyParams}{\-Parameters}
{\em states} & \-Array containing the sites's states ({\bfseries input/{\bfseries output})} \par
 \-The state of trapped sites is updated to {\bfseries state(i)=trapped}\\
\hline
{\em undo\-\_\-invasion} & \-Flag\-: \-If {\bfseries undo\-\_\-invasion==.true.} \-Then use fast a posteriori method for trapping ({\bfseries input})\\
\hline
{\em invasion\-\_\-list} & \-List of invaded sites sorted in chronological order ({\bfseries input})\\
\hline
{\em offsets} & \-Array containing the offsets of the data stored in the connectivity array ({\bfseries \-Input})\\
\hline
{\em connectivity} & \-Array containing thelattice connectivity ({\bfseries input}) \par
 \-For a given site {\bfseries i}, with offset {\bfseries j = offsets(i)} \-: \par
 {\bfseries n=connectivity(j)} is the number of sites neighboring site {\bfseries i}. \par
 {\bfseries connectivity(j+1, j+2, ... ,j+n)} contains the indices of the sites that are neighboring site {\bfseries i}. \\
\hline
\end{DoxyParams}
\hypertarget{classadd__trapping_a06df99a584626d4aac4d7b24332f62ba}{
\index{add\-\_\-trapping@{add\-\_\-trapping}!find\-\_\-trapped\-\_\-sites\-\_\-cubic@{find\-\_\-trapped\-\_\-sites\-\_\-cubic}}
\index{find\-\_\-trapped\-\_\-sites\-\_\-cubic@{find\-\_\-trapped\-\_\-sites\-\_\-cubic}!add_trapping@{add\-\_\-trapping}}
\subsubsection[{find\-\_\-trapped\-\_\-sites\-\_\-cubic}]{\setlength{\rightskip}{0pt plus 5cm}subroutine add\-\_\-trapping\-::find\-\_\-trapped\-\_\-sites\-\_\-cubic (
\begin{DoxyParamCaption}
\item[{integer}]{nx, }
\item[{integer}]{ny, }
\item[{integer}]{nz, }
\item[{integer, dimension(nx,ny,nz)}]{states, }
\item[{logical}]{period\-\_\-x, }
\item[{logical}]{period\-\_\-y, }
\item[{logical}]{period\-\_\-z, }
\item[{integer}]{n\-\_\-sites\-\_\-invaded, }
\item[{integer, dimension(\-:)}]{invasion\-\_\-list, }
\item[{logical}]{undo\-\_\-invasion}
\end{DoxyParamCaption}
)}}
\label{classadd__trapping_a06df99a584626d4aac4d7b24332f62ba}


\-Identify trapped sites on cubic lattices. 

\begin{DoxyAuthor}{\-Author}
\-Yder \-M\-A\-S\-S\-O\-N 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
\-October 23, 2014
\end{DoxyDate}
\-It uses the fast a posteriori identification of trapped node if the {\bfseries undo\-\_\-invasion=.true.}. \-If {\bfseries undo\-\_\-invasion=.false.} cluster labeling is performed at each invasion steps. 
\begin{DoxyParams}{\-Parameters}
{\em nx} & \-Grid dimension in the x direction ({\bfseries input}) \\
\hline
{\em ny} & \-Grid dimension in the y direction ({\bfseries input}) \\
\hline
{\em nz} & \-Grid dimension in the z direction ({\bfseries input}) \\
\hline
{\em states} & \-Array containing the sites's states ({\bfseries input/{\bfseries output})} \par
 \-The state of trapped sites is updated to {\bfseries state(i,j,k)=trapped} \\
\hline
{\em period\-\_\-x} & \-Flag for periodic boundaries in the x direction ({\bfseries input}) \\
\hline
{\em period\-\_\-y} & \-Flag for periodic boundaries in the y direction ({\bfseries input}) \\
\hline
{\em period\-\_\-z} & \-Flag for periodic boundaries in the z direction ({\bfseries input}) \\
\hline
{\em undo\-\_\-invasion} & \-Flag\-: \-If {\bfseries undo\-\_\-invasion==.true.} \-Then use fast a posteriori method for trapping ({\bfseries input}) \\
\hline
{\em n\-\_\-sites\-\_\-invaded} & \-Number of invaded sites ({\bfseries input}) \\
\hline
{\em invasion\-\_\-list} & \-List of invaded sites sorted in chronological order ({\bfseries input}) \\
\hline
\end{DoxyParams}
\hypertarget{classadd__trapping_a3ecc26d4e45d30eb3f1ea423c2464d57}{
\index{add\-\_\-trapping@{add\-\_\-trapping}!get\-\_\-label\-\_\-free\-\_\-clusters@{get\-\_\-label\-\_\-free\-\_\-clusters}}
\index{get\-\_\-label\-\_\-free\-\_\-clusters@{get\-\_\-label\-\_\-free\-\_\-clusters}!add_trapping@{add\-\_\-trapping}}
\subsubsection[{get\-\_\-label\-\_\-free\-\_\-clusters}]{\setlength{\rightskip}{0pt plus 5cm}integer function add\-\_\-trapping\-::get\-\_\-label\-\_\-free\-\_\-clusters (
\begin{DoxyParamCaption}
\item[{}]{n\-\_\-sites, }
\item[{integer, dimension(n\-\_\-sites)}]{states, }
\item[{integer, dimension(n\-\_\-sites)}]{mat}
\end{DoxyParamCaption}
)}}
\label{classadd__trapping_a3ecc26d4e45d30eb3f1ea423c2464d57}


\-Ths function does the union of the labels of all sites connected to an exit site and return the corresponding label that is the free cluster's label. 

\begin{DoxyAuthor}{\-Author}
\-Yder \-M\-A\-S\-S\-O\-N 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
\-October 23, 2014
\end{DoxyDate}

\begin{DoxyParams}{\-Parameters}
{\em states} & \-Array containing the sites's states ({\bfseries input}) \\
\hline
{\em mat} & \-Array containing the clusters's labels ({\bfseries input}) \\
\hline
\end{DoxyParams}


\-The documentation for this module was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
modules/src/\hyperlink{module__trapping_8f90}{module\-\_\-trapping.\-f90}\end{DoxyCompactItemize}
